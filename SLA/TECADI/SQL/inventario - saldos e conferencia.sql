SELECT FILIAL, CODIGO, "LOCAL", ENDERECO, PRODUTO, SUM(PREVISTO) SUM_PREVISTO, SUM(REALIZADO) SUM_REALIZADO, CONTAGEM
 FROM (
SELECT 'REALIZADO' TIPO, Z19_FILIAL FILIAL ,Z19_IDENT CODIGO,Z19_LOCAL "LOCAL",Z19_ENDERE ENDERECO, Z19_CODPRO PRODUTO, 
		0 AS PREVISTO,COALESCE(Z19_QUANT,0) AS REALIZADO, Z19_CONTAG CONTAGEM 
FROM Z19010 Z19 (nolock)						
WHERE Z19_IDENT IN (
'076074',
'076073',
'076060',
'076059',
'075921',
'075821',
'075782',
'075781',
'075780',
'075775'
)  AND Z19.D_E_L_E_T_=' '
UNION
SELECT 'PREVISTO' TIPO, Z21_FILIAL FILIAL ,Z21_IDENT CODIGO,Z21_LOCAL "LOCAL",Z21_LOCALI ENDERECO,Z21_PROD PRODUTO,
		COALESCE(Z21_QUANT,0) PREVISTO, 0 REALIZADO, Z21_NRCONT CONTAGEM 
FROM Z21010 Z21 (nolock) 
WHERE Z21_IDENT IN (
'076074',
'076073',
'076060',
'076059',
'075921',
'075821',
'075782',
'075781',
'075780',
'075775'
) AND Z21.D_E_L_E_T_=' ' 
) A
JOIN Z06010 (nolock) ON Z06_NUMOS=CODIGO AND Z06_NRCONT=CONTAGEM AND D_E_L_E_T_=' ' AND Z06_STATUS NOT IN ('CA','AG')
GROUP BY FILIAL, CODIGO, "LOCAL", ENDERECO, PRODUTO, CONTAGEM
HAVING SUM(PREVISTO) <> SUM(REALIZADO)
ORDER BY FILIAL, CODIGO, "LOCAL", ENDERECO, PRODUTO, CONTAGEM


SELECT 'PREVISTO' TIPO, Z21_FILIAL FILIAL ,Z21_IDENT CODIGO,Z21_LOCAL "LOCAL",Z21_LOCALI ENDERECO,Z21_PROD PRODUTO,
		Z21_QUANT PREVISTO, 0 REALIZADO, Z21_NRCONT CONTAGEM, *
FROM Z21010 Z21 (nolock) 
WHERE Z21_IDENT IN (
'076074',
'076073',
'076060',
'076059',
'075921',
'075821',
'075782',
'075781',
'075780',
'075775'
) AND Z21_IDENT = '075821' AND  Z21_LOCALI='53A050418772' AND Z21_PROD='SAMSDC6009002' AND Z21.D_E_L_E_T_=' ' AND Z21_NRCONT='002'

SELECT * FROM Z16010 WHERE Z16_ENDATU='53A050418772' AND Z16_CODPRO='SAMSDC6009002'


--select * from Z19010 where Z19_IDENT='075780'

-- SELECT * FROM Z06010 WHERE Z06_NUMOS IN ('075780','076073','076058')
--SELECT * FROM Z05010 WHERE Z05_NUMOS IN ('075780','076073')

/*



SELECT TOP 10  * FROM Z16010 /*WHERE Z16_ENDERE='09B040103097   ' */ ORDER BY R_E_C_N_O_ DESC

SELECT * FROM SBF010 WHERE BF_LOCALIZ='09B040103097   ' AND D_E_L_E_T_=' '
SELECT * FROM SBF010 WHERE BF_PRODUTO='DANULM816' AND D_E_L_E_T_=' '
SELECT SUM(D2_QUANT) FROM SD2010 WHERE D2_COD='DANULM816' AND D_E_L_E_T_=' '


select SUM(D1_QUANT) from SD1010  WHERE D1_COD='DANULM816' AND D_E_L_E_T_=' '
SELECT SUM(D2_QUANT) FROM SD2010 WHERE D2_COD='DANULM816'   AND D_E_L_E_T_=' '                   

select * from SD3010 where D3_COD='DANULM816' AND D3_LOCALIZ='09B040103097   '
select * from SD3010 where D3_COD='DANULM806' AND D3_LOCALIZ='02B10010065501 '

SELECT * FROM SBF010 WHERE BF_LOCALIZ='02B10010065501 ' AND D_E_L_E_T_=' '
SELECT * FROM SBF010 WHERE BF_PRODUTO='DANULM806' AND D_E_L_E_T_=' '
--103	076073	01	02B10010065501 	DANULM977 

*/


--53A050418772   	SAMSDC6009002                 

SELECT * FROM SBF010 WHERE BF_LOCALIZ='09B040103097   ' AND D_E_L_E_T_=' '
SELECT * FROM SBF010 WHERE BF_PRODUTO='DANULM816' AND D_E_L_E_T_=' '


SELECT * FROM Z21010 WHERE Z21_LOCALI='09B040103097' AND Z21_IDENT='' AND D_E_L_E_T_=' ' ORDER BY Z21_IDENT DESC




select TOP 10 * from SBE010 WHERE BE_ZIDETIQ='0002025697'

SELECT * FROM Z21010 WHERE Z21_ETQVOL='0002025697' AND D_E_L_E_T_=' '
SELECT * FROM Z16010 WHERE Z16_ETQVOL='0002025697' AND D_E_L_E_T_=' '

SELECT * FROM SBF010 WHERE BF_LOCALIZ='08A040402560   '
SELECT * FROM SBF010 WHERE BF_PRODUTO='DANULM592' AND D_E_L_E_T_=' '

SELECT * FROM Z19010 WHERE Z19_CODPRO = 'DANULM592' AND D_E_L_E_T_=' '







SELECT Z21_QUANT,Z16_QUANT, Z16_SALDO, Z21_FILIAL,Z21_PROD,Z21_LOCAL,Z21_PRIOR,Z21_LOCALI,Z21_NUMSER,Z21_LOTE,Z21_NUMLOT,
		Z21_QUANT,Z21_ESTFIS,Z21_IDENT,Z21_NRCONT,Z21_ETQPAL,Z21_ETQPRD,Z21_ETQVOL,Z21_ETQCLI,Z21_NUMSEQ  
FROM Z21010 Z21 
LEFT JOIN Z16010 Z16 ON Z16_FILIAL=Z21_FILIAL AND Z16_CODPRO=Z21_PROD AND Z16_LOCAL=Z21_LOCAL AND Z16_ENDATU=Z21_LOCALI AND Z16_ETQPAL=Z21_ETQPAL AND Z16_ETQCLI=Z21_ETQCLI AND Z16_ETQVOL=Z21_ETQVOL AND Z16.D_E_L_E_T_=' '
WHERE Z21_FILIAL='103' AND Z21_IDENT='075821' AND Z21_LOCAL='01' AND Z21_LOCALI='53A050418772'--   	SAMSDC6009002                 
AND Z21.D_E_L_E_T_=' '


SELECT * 
FROM Z16010 Z16 
WHERE Z16_FILIAL='103'
AND Z16_CODPRO='SAMSDC6009002'
AND Z16_LOCAL='01'
AND Z16_ENDATU='53A050418772   ' AND Z16.D_E_L_E_T_=' '
--AND Z16_ETQVOL='0001762562'
--AND Z16_CODBAR -- VERIFICAR DE QUAL CADASTRO VEM A INFORMAÇÃO
--AND Z16_LOTCTL
--AND Z16_



SELECT * FROM Z16010 WHERE Z16_ETQVOL='0001762562'
SELECT * FROM Z16010 WHERE Z16_ETQVOL='0001762562'


SELECT top 10 * FROM SBF010 WHERE BF_PRODUTO='SAMSDC6009002' AND BF_LOCALIZ='53A050418772'
SELECT top 10 * FROM Z16010 WHERE Z16_CODPRO='SAMSDC6009002' AND Z16_ETQPRD=''

select TOP 10 * from Z07010
select TOP 10 * from Z08010
select TOP 10 * from Z09010
select TOP 10 * from Z29010


SELECT TOP 10 * FROM Z17010 WHERE Z17_ETQPLT='0001765694'


select * from SBF010 WHERE BF_PRODUTO='SAMSDC6009002' AND BF_LOCALIZ='53A050418772   '

SELECT * FROM SBF010 WHERE BF_FILIAL='103' AND BF_LOCAL='01' AND BF_LOCALIZ='53A050418772   ' AND BF_PRODUTO='SAMSDC6009002'

select TOP 10  * from SDA010 WHERE  DA_PRODUTO='SAMSDC6009002'
select TOP 10  * from SDB010 WHERE  DB_PRODUTO='SAMSDC6009002' AND DB_LOCALIZ='53A050418772   '


select * FROM SBF010 WHERE BF_LOCALIZ ='LOST' AND BF_QUANT > 0